-- Question: Show name of diseases where the gene expression with symbol A1BG has a statistical significance of 'Yes'
-- SQL: SELECT disease.name
FROM differential_expression
         JOIN disease ON differential_expression.doid = disease.id
WHERE differential_expression.gene_symbol = 'A1BG'
  and differential_expression.statistical_significance = 'Yes'

-- Question: Show biomarker gene symbol and description for 'breast cancer'
-- SQL: SELECT biomarker.gene_symbol, biomarker.biomarker_description
FROM biomarker
         JOIN biomarker_fda on biomarker.id = biomarker_fda.id
         JOIN biomarker_fda_test ON biomarker_fda.test_submission = biomarker_fda_test.test_submission and
                                    biomarker_fda.test_trade_name = biomarker_fda_test.test_trade_name
         JOIN disease ON disease.id = biomarker_fda_test.doid
WHERE disease.name = 'breast cancer'

-- Question: How many biomarkers are associated with each anatomical entity?
-- SQL: SELECT anatomical_entity.name, COUNT(*)
FROM biomarker
JOIN biomarker_edrn ON biomarker.id = biomarker_edrn.id
JOIN anatomical_entity ON biomarker_edrn.uberon_anatomical_id = anatomical_entity.id
GROUP BY anatomical_entity.name

-- Question: Show the pvalue of differential expression of lung cancer
-- SQL: SELECT differential_expression.pvalue
FROM differential_expression
         JOIN disease ON differential_expression.doid = disease.id
WHERE disease.name = 'lung cancer'

-- Question: Get the biomarker gene symbol and biomarker description for disease with name 'breast cancer'
-- SQL: SELECT biomarker.gene_symbol, biomarker.biomarker_description
FROM biomarker
         JOIN biomarker_fda on biomarker.id = biomarker_fda.id
         JOIN biomarker_fda_test ON biomarker_fda.test_submission = biomarker_fda_test.test_submission and
                                    biomarker_fda.test_trade_name = biomarker_fda_test.test_trade_name
         JOIN disease ON disease.id = biomarker_fda_test.doid
WHERE disease.name = 'breast cancer'

-- Question: Show all the information about biomarkers and the species for which they are healthy expressed
-- SQL: select bio.biomarker_description, species.species
from biomarker as bio
    join biomarker_edrn as be on bio.id = be.id
    join anatomical_entity as ae on be.uberon_anatomical_id = ae.id
    join healthy_expression as he on ae.id = he.uberon_anatomical_id
    join xref_gene_ensembl as xge on he.ensembl_gene_id = xge.ensembl_gene_id
    join species as s on xge.speciesid = s.speciesid

-- Question: How many FDA tests did manufacturer 23andMe?
-- SQL: SELECT count(*)
FROM biomarker_fda_test
WHERE biomarker_fda_test.test_manufacturer = '23andMe'

-- Question: Who manufactures lung cancer prognosis tests that are approved by the FDA?
-- SQL: SELECT distinct(d.name), bft.test_trade_name, bft.test_manufacturer
FROM biomarker_fda_test_use as bftu JOIN biomarker_fda_test as bft 
        ON bft.test_trade_name = bftu.test_trade_name 
        AND bft.test_submission = bftu.test_submission 
JOIN biomarker_fda as bf ON bft.test_trade_name = bf.test_trade_name 
        AND bft.test_submission = bf.test_submission 
JOIN biomarker as b ON bf.id = b.id
JOIN disease AS d ON d.id = bft.doid
WHERE
        bftu.approved_indication LIKE '%prognosis%'
                AND d.name LIKE '%lung%'

-- Question: Show disease mutation chromosome positions for skin cancer
-- SQL: SELECT disease_mutation.chromosome_pos
FROM disease_mutation
         JOIN disease ON disease_mutation.doid = disease.id
WHERE disease.name = 'skin cancer'

-- Question: Show all information about disease mutations of the anatomical entity liver
-- SQL: SELECT *
FROM disease_mutation
         JOIN disease_mutation_tissue ON disease_mutation.id = disease_mutation_tissue.disease_mutation_id
         JOIN anatomical_entity ON disease_mutation_tissue.uberon_anatomical_id = anatomical_entity.id
WHERE anatomical_entity.name = 'liver'

-- Question: Show all of the edrn biomarkers that have been approved by the FDA
-- SQL: SELECT t1.id from biomarker as t1 join biomarker_edrn as t2 on t1.id = t2.id WHERE t1.id
IN (SELECT t1.id from biomarker as t1 join biomarker_fda as t2 on t1.id = t2.id join biomarker_fda_test_use as bftu on t2.test_submission = bftu.test_submission)

-- Question: What disease can occur in the liver?
-- SQL: SELECT disease.name
FROM anatomical_entity
         JOIN cancer_tissue ON anatomical_entity.id = cancer_tissue.uberon_anatomical_id
         JOIN disease ON cancer_tissue.doid = disease.id
WHERE anatomical_entity.name = 'liver'

-- Question: Get the p-value of differential expressions for the disease 'lung cancer'
-- SQL: SELECT differential_expression.pvalue
FROM differential_expression
         JOIN disease ON differential_expression.doid = disease.id
WHERE disease.name = 'lung cancer'

-- Question: Show all FDA test manufacturer for biomarkers of gene BRAF
-- SQL: SELECT biomarker_fda_test.test_manufacturer
FROM biomarker
         JOIN biomarker_fda on biomarker.id = biomarker_fda.id
         JOIN biomarker_fda_test
              ON biomarker_fda.test_trade_name = biomarker_fda_test.test_trade_name AND biomarker_fda.test_submission = biomarker_fda_test.test_submission
WHERE biomarker.gene_symbol = 'BRAF'

-- Question: How many healthy expression are there for stage name starting with 'late adult'?
-- SQL: SELECT COUNT(*) FROM healthy_expression JOIN stage ON healthy_expression.uberon_developmental_id = stage.id WHERE stage.name LIKE 'late adult%'

-- Question: Identify a list of genes expressed in lung cancer
-- SQL: SELECT differential_expression.gene_symbol
FROM differential_expression
         JOIN disease ON differential_expression.doid = disease.id
WHERE disease.name = 'lung cancer'

-- Question: In how many fda test trials was test manufacturer 'ABBOTT MOLECULAR INC' involved?
-- SQL: SELECT count(*)
FROM biomarker_fda_test
         JOIN biomarker_fda_test_trial
              ON biomarker_fda_test.test_submission = biomarker_fda_test_trial.test_submission and
                 biomarker_fda_test.test_trade_name = biomarker_fda_test_trial.test_trade_name
WHERE test_manufacturer = 'ABBOTT MOLECULAR INC'

-- Question: Show all approved tests for breast cancer biomarkers
-- SQL: select *
from biomarker as b join
biomarker_fda as bf on b.id = bf.id
join biomarker_fda_test as bft on 
bf.test_trade_name = bft.test_trade_name and bf.test_submission = bft.test_submission
join biomarker_fda_test_use as  bfu on 
bfu.test_trade_name = bft.test_trade_name and bfu.test_submission = bft.test_submission
where b.gene_symbol like '%BRCA%'

-- Question: Show name of diseases where the A1BG gene expression is statistically significant
-- SQL: SELECT disease.name
FROM differential_expression
         JOIN disease ON differential_expression.doid = disease.id
WHERE differential_expression.gene_symbol = 'A1BG'
  and differential_expression.statistical_significance = 'Yes'

-- Question: show me all the genes that relate to biomarkers of prostate cancer.
-- SQL: select biomarker.gene_symbol
from disease as dis
join biomarker_fda_test as fda on dis.id = fda.doid
join biomarker_fda as bio_fda on bio_fda.test_trade_name = fda.test_trade_name
join biomarker as bio on bio.id = biomarker_fda.id
where dis.name = "prostate cancer"

-- Question: What are the symbols for biomarkers with type genomic for anatomical entity breast?
-- SQL: SELECT gene_symbol
FROM biomarker
         JOIN biomarker_edrn ON biomarker.id = biomarker_edrn.id
         JOIN anatomical_entity ON biomarker_edrn.uberon_anatomical_id = anatomical_entity.id
WHERE anatomical_entity.name = 'breast'
  and biomarker_edrn.biomarker_type = 'Genomic'

-- Question: Show me the name of anatomical entities and species for all species
-- SQL: SELECT anatomical_entity.name, species.speciescommonname
FROM anatomical_entity
         JOIN healthy_expression ON anatomical_entity.id = healthy_expression.uberon_anatomical_id
         JOIN xref_gene_ensembl ON healthy_expression.ensembl_gene_id = xref_gene_ensembl.ensembl_gene_id
         JOIN species ON xref_gene_ensembl.speciesid = species.speciesid

-- Question: Show distinct manufacturer of diagnostic tests for gene BRAF
-- SQL: SELECT distinct(biomarker_fda_test.test_manufacturer), biomarker_fda_test_use.actual_use
FROM biomarker
         JOIN biomarker_fda on biomarker.id = biomarker_fda.id
         JOIN biomarker_fda_test
              ON biomarker_fda.test_trade_name = biomarker_fda_test.test_trade_name AND
                 biomarker_fda.test_submission = biomarker_fda_test.test_submission
         JOIN biomarker_fda_test_use ON biomarker_fda_test.test_submission = biomarker_fda_test_use.test_submission and biomarker_fda_test.test_trade_name = biomarker_fda_test_use.test_trade_name
WHERE biomarker.gene_symbol = 'BRAF'
  AND biomarker_fda_test_use.actual_use = 'diagnostic'

-- Question: List the name of diseases that can occur in the anatomical entity 'liver'
-- SQL: SELECT disease.name
FROM anatomical_entity
         JOIN cancer_tissue ON anatomical_entity.id = cancer_tissue.uberon_anatomical_id
         JOIN disease ON cancer_tissue.doid = disease.id
WHERE anatomical_entity.name = 'liver'

-- Question: How many healthy expression are there for 'late adult stage'?
-- SQL: SELECT COUNT(*) FROM healthy_expression JOIN stage ON healthy_expression.uberon_developmental_id = stage.id WHERE stage.name = 'late adult stage'

-- Question: Get the name of all anatomical entities starting with 'bone'
-- SQL: SELECT name FROM anatomical_entity WHERE name LIKE 'bone%'

-- Question: Show me all information about species
-- SQL: SELECT * FROM species

-- Question: What is the test trade name for FDA tests where actual use is 'predisposition'?
-- SQL: SELECT test_trade_name FROM biomarker_fda_test_use WHERE actual_use = 'predisposition'

-- Question: Show the gene symbol and the description of cancer biomarkers which are not in a panel
-- SQL: SELECT biomarker.gene_symbol, biomarker_description FROM biomarker WHERE test_is_a_panel = 'false'

-- Question: Show me all disease mutations with ref_aa E
-- SQL: SELECT * FROM disease_mutation WHERE ref_aa = 'E'

